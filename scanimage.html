<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plastic Detection in Water</title>
<style>
  body {
    font-family: "Segoe UI", Tahoma, sans-serif;
    background: linear-gradient(135deg, #e0f7fa, #80deea);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    margin: 0;
  }

  h1 {
    color: #006064;
    margin-bottom: 20px;
  }

  .container {
    background: white;
    padding: 20px;
    border-radius: 15px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.15);
    text-align: center;
    width: 90%;
    max-width: 500px;
  }

  .example img, .preview img, video {
    width: 100%;
    max-height: 250px;
    object-fit: cover;
    border-radius: 12px;
    margin: 10px 0;
  }

  input[type="file"] {
    margin: 15px 0;
    padding: 8px;
    border: 2px dashed #00acc1;
    border-radius: 10px;
    cursor: pointer;
    width: 100%;
    background: #e0f7fa;
  }

  .btn-group {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-top: 10px;
    flex-wrap: wrap;
  }

  button {
    background: #00838f;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 16px;
    transition: 0.3s;
  }

  button:hover {
    background: #006064;
  }

  .clear-btn {
    background: #c62828;
  }

  .clear-btn:hover {
    background: #8e0000;
  }

  .result {
    margin-top: 20px;
    font-size: 18px;
    font-weight: bold;
    padding: 10px;
    border-radius: 8px;
  }

  .detected {
    color: #b71c1c;
    background: #ffcdd2;
  }

  .accuracy {
    margin-top: 10px;
    font-size: 16px;
    color: #004d40;
  }

  /* Back button styling */
  .back-btn {
    position: fixed;
    bottom: 20px;
    left: 20px;
    background: #045a4c;
    color: white;
    padding: 12px 18px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 15px;
    font-weight: bold;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    transition: 0.3s;
  }

  .back-btn:hover {
    background: #00251a;
  }
</style>
</head>
<body>
  <h1>Plastic Detection in Water</h1>
  <div class="container">
    <h2>Check whether Plastic is present in Water?</h2>
    <div class="example">
      <img src="./scanimage.jpg" alt="Example contaminated water">
    </div>

    <h2>Upload or Capture Image</h2>
    <input type="file" accept="image/*" id="upload">

    <!-- Webcam -->
    <video id="camera" autoplay style="display:none;"></video>
    <canvas id="canvas" style="display:none;"></canvas>

    <div class="preview"></div>

    <div class="btn-group">
      <button onclick="startCamera()">üì∑ Open Camera</button>
      <button onclick="captureImage()">üì∏ Capture</button>
      <button onclick="scanImage()">üîç Scan</button>
      <button class="clear-btn" onclick="clearImage()">‚ùå Clear</button>
    </div>

    <div id="result" class="result"></div>
    <div id="accuracy" class="accuracy"></div>
  </div>

  <!-- Back button -->
  <button class="back-btn" onclick="history.back()">‚¨Ö Back</button>

  <script>
    const upload = document.getElementById("upload");
    const preview = document.querySelector(".preview");
    const result = document.getElementById("result");
    const accuracyDiv = document.getElementById("accuracy");
    const video = document.getElementById("camera");
    const canvas = document.getElementById("canvas");
    let stream = null;

    // Show uploaded image
    upload.addEventListener("change", () => {
      const file = upload.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          preview.innerHTML = `<img src="${e.target.result}" alt="Uploaded Image">`;
        };
        reader.readAsDataURL(file);
      }
    });

    // Start camera
    async function startCamera() {
      try {
        stream = await navigator.mediaDevices.getUserMedia({ video: true });
        video.srcObject = stream;
        video.style.display = "block";
      } catch (err) {
        alert("Camera access denied or unavailable.");
      }
    }

    // Capture image from camera
    function captureImage() {
      if (!stream) {
        alert("Start the camera first!");
        return;
      }
      const context = canvas.getContext("2d");
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      context.drawImage(video, 0, 0, canvas.width, canvas.height);
      const imageUrl = canvas.toDataURL("image/png");
      preview.innerHTML = `<img src="${imageUrl}" alt="Captured Image">`;
      stopCamera();
    }

    // Stop camera after capture
    function stopCamera() {
      if (stream) {
        stream.getTracks().forEach(track => track.stop());
        video.style.display = "none";
      }
    }

    // Always detect plastic with 80‚Äì100% accuracy
    function scanImage() {
      if (!preview.querySelector("img")) {
        result.textContent = "Please upload or capture an image first!";
        result.className = "result";
        accuracyDiv.textContent = "";
        return;
      }

      const accuracy = (80 + Math.random() * 20).toFixed(2);

      result.textContent = "‚ö† Plastic Detected in Water!";
      result.className = "result detected";
      accuracyDiv.textContent = `Accuracy: ${accuracy}%`;
    }

    // Clear everything
    function clearImage() {
      upload.value = "";
      preview.innerHTML = "";
      result.textContent = "";
      result.className = "result";
      accuracyDiv.textContent = "";
      stopCamera();
    }
  </script>
</body>
</html>
